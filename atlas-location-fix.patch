--- a/src/App.jsx
+++ b/src/App.jsx
@@ -528,6 +528,17 @@
   return `--- probe ${idx + 1}: ${p.city || ""} ${p.country || ""} AS${p.asn || ""} ${p.network || ""}`.trim();
 }
 
+function formatProbeLocation(probe) {
+  if (!probe) return "-";
+  const city = String(probe.city ?? "").trim();
+  const country = String(probe.country ?? probe.country_code ?? "").trim();
+  if (city && country) return `${city}, ${country}`;
+  if (city) return city;
+  if (country) return country;
+  if (probe.id !== undefined && probe.id !== null) return `Probe ${probe.id}`;
+  return "-";
+}
+
 function applyGpTag(fromStr, tag) {
   const t = (tag || "").trim();
   if (!t || t === "any") return (fromStr || "").trim();
@@ -2923,7 +2934,7 @@
                 <tr key={r.key}>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.idx + 1}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>
-                    {r.probe ? `${r.probe.city}, ${r.probe.country}` : "-"}
+                    {formatProbeLocation(r.probe)}
                   </td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.asn ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.network ?? "-"}</td>
@@ -2980,7 +2991,7 @@
               {trCompare.rows.map((r) => (
                 <tr key={r.key}>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.idx + 1}</td>
-                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.city ? `${r.probe.city}, ${r.probe.country}` : "-"}</td>
+                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{formatProbeLocation(r.probe)}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.asn ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.network ?? "-"}</td>
 
@@ -3020,7 +3031,7 @@
                   <tr key={row.key}>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{idx + 1}</td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>
-                      {row.probe?.city ? `${row.probe.city}, ${row.probe.country}` : "-"}
+                      {formatProbeLocation(row.probe)}
                     </td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{row.v4path}</td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{row.v6path}</td>
@@ -3077,7 +3088,7 @@
               {mtrCompare.rows.map((r) => (
                 <tr key={r.key}>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.idx + 1}</td>
-                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.city ? `${r.probe.city}, ${r.probe.country}` : "-"}</td>
+                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{formatProbeLocation(r.probe)}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.asn ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.network ?? "-"}</td>
 
@@ -3120,7 +3131,7 @@
                   <tr key={row.key}>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{idx + 1}</td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>
-                      {row.probe?.city ? `${row.probe.city}, ${row.probe.country}` : "-"}
+                      {formatProbeLocation(row.probe)}
                     </td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{row.v4path}</td>
                     <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{row.v6path}</td>
@@ -3170,7 +3181,7 @@
                 <tr key={r.key}>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.idx + 1}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>
-                    {r.probe?.city ? `${r.probe.city}, ${r.probe.country}` : "-"}
+                    {formatProbeLocation(r.probe)}
                   </td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.asn ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.network ?? "-"}</td>
@@ -3227,7 +3238,7 @@
               {httpCompare.rows.map((r) => (
                 <tr key={r.key}>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.idx + 1}</td>
-                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.city ? `${r.probe.city}, ${r.probe.country}` : "-"}</td>
+                  <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{formatProbeLocation(r.probe)}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.asn ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.probe?.network ?? "-"}</td>
                   <td style={{ padding: "6px 8px", borderBottom: "1px solid #eee" }}>{r.v4sc ?? "-"}</td>
